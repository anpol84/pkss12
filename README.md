# Проектирование клиент-серверной системы "Гостиница"
## Структура функциональных возможностей

```mermaid
mindmap
  root((Клиент-серверное приложение гостиница))
    Технологии
      Языки программирования
        Java
        JavaScript
      Базы данных
        PostgreSQL
      Брокеры
        Apache Kafka
      Сетевые протоколы
        http
        tcp
        jdbc
    Компоненты
      Клиент
        Веб-приложение на React
      Сервер
        Балансировщик нагрузки Nginx
        Веб-сервер Apache Tomcat
        Сервер приложения на Spring
        Брокер сообщений Apache Kafka
      База данных
        Сервер базы данных PostgreSQL
    Архитектура
      Многоуровневая
        Клиент
        База данных
        Сервер из микросервисов
          Сервис авторизации
          Сервис бронирования
          Сервис работы с клиентами
          Сервис писем
          Сервис взаимодействия с нейросетью
          Сервис работы с горничными
          Сервис работы с номерами
          Сервис создания отчета
          Сервис валидации
          Сервис чеков
    Задачи проектирования
      Моделирование
        С4
        UML
        IDEF0
      Оптимизация
        Балансировка нагрузки
        Масштабирование
```
### Пояснение диаграммы
Данная диаграмма предназначена, чтобы структурировать и визуализировать информацию об устройстве клиент-серверной системы "Гостиница". На диаграмме указан стек, архитектура, компоненты и задачи проектирования данной системы.

1. Технологии: Сервер написан на языке Java, фреймворк Spring, клиент - написан на языке JavaScript, фреймворк React. В качестве базы данных используется реляционная база данных PostgreSQL, в качестве брокера сообщений - Apache Kafka. Общение между клиентом и сервером происходит по протоколу http, между сервером и брокером - по проколу tcp, между сервером и базой данных - по протоколу jdbc.
2. Компоненты: Клиент написан на языке JavaScript, React, и представляет из себя веб-приложение. Сервер написан на языке Java, Spring, состоит из встроеннго веб-сервера Apache Tomcat, сервера приложений Spring, брокера сообщений Apache Kafka и балансировщика нагрузки Nginx. База данных представляет собой реляционную базу данных PostgreSQL.
3. Архитектура: приложение используется трехуровневую архитектуру, разделяясь на клиент, сервер и базу данных. Сервер использует микросервисы. Сервис авторизации отвечает за регистрацию и вход пользователей, валидации - за валидирование запросов пользователей, бронирования - за бронирование комнат, работы с клиентами - за работу с клиентами, писем - за отправку писем горничным, нейросети - за взаимодействие с API нейросети, работы с горничными - за работу с горничными, работы с номерами - за работу с номера, отчетов - за создания отчетов о бронировании, чеков - за создании чека бронирования.
4. Задачи проектирования: При проектировании использовались различные диаграммы в нотациях C4, UML, IDEF0, IDEF3, DFD. Основные проблемы, решаемые при проектировании, - способы масштабироваться и балансировать нагрузку.

## Диаграмма путешествия пользователя 
```mermaid
journey
    title Взаимодействие с клиент-серверной системой "Гостиница"
    section Вход в систему
      Регистрация: 5: Пользователь
      Авторизация: 3: Пользователь
      Отправка данных пользователя: 3: Клиент
      Обработка нового пользователя: 3: Сервер
      Валидация данных пользователя: 3: Сервер
    section Просмотр комнат
      Вход на страницу комнат: 5: Пользователь
      Запрос на выдачу комнат: 3: Клиент
      Выдача комнат из БД: 3: Сервер
    section Бронирование комнаты
      Ввод параметров комнаты: 5: Пользователь
      Отправка параметров на сервер: 3: Клиент
      Определение и бронирование подходящей комнаты: 3: Сервер
    section Просмотреть брони
      Вход в личный кабинет: 5: Пользователь
      Запросы на выдачу броней: 3: Клиент
      Выдача броней из БД: 3: Сервер
```
### Пояснение диаграммы
Данная диаграмма предназначена, чтобы отобразить основные сценарии использования данной системы пользователем.
Сценарии использования:
1. Вход/регистрация: пользователь может войти в аккаунт, либо зарегистироваться, при этом клиент отправляет данные пользователя на сервер, а тот и обрабатывает, валидиурет или создает нового пользователя.
2. Просмотр комнат: пользователь может зайти на страницу комнат, чтобы просмотреть их характеристики, при этом клиент отправляет запрос о данных комнат, сервер берет эти данные из базы данных.
3. Бронирование комнаты: пользователь может забронировать комнату, он должен ввести необходимые параметры, клиент отправит их на сервер, а сервер в соотвествии с параметрами подберет и забронирует комнату.
4. Просмотр брони: пользователь может зайти в личный кабинет и посмотреть свои брони, клиент сделает за запрос за бронями на сервер, а тот возьмет их из базы данных.

## Квадрант-граф 
```mermaid
quadrantChart
    title Приоритет разработки функционала
    x-axis Low Reach --> High Reach
    y-axis Low Engagement --> High Engagement
    quadrant-1 We should expand
    quadrant-2 Need to promote
    quadrant-3 Re-evaluate
    quadrant-4 May be improved
    Introduce vpa scaling: [0.6, 0.67]
    Enter the feedback form: [0.13, 0.85]
    Update information about rooms: [0.7, 0.8]
    Increase database resources: [0.7, 0.9]
    Improve pagination: [0.35, 0.78]
    Add a quick filter: [0.16, 0.64]
    Add a dark theme: [0.4, 0.1]
    Add a dialog with a neural network: [0.17, 0.25]
    Develop a mobile application: [0.2, 0.4]
    Consider integration with the new payment system: [0.8, 0.4]
    Add favorites to the contribution: [0.7, 0.2]
    Add sorting by rating: [0.65, 0.3]
```
### Пояснение диаграммы
Данная диаграмма предназначена, чтобы расписать актуальные задачи над системой их приоритет.
1. Нужно немедленно реализовать VPA мастшабирование и увеличить ресурсы базы данных - поток пользователей повышается, необходимо повышать ресурсы. Также данные о комнатах поменялись, необходимо срочно обновить информацию на сервере.
2. Пользователи страдают от неудобной и медленной работы приложения: нужно в ближайшее время улучшить алгоритмы фильтрации и пагинации. Также в ближайшее время необходимо добавить форму обратной связи, чтобы знать мнение пользователей о системе.
3. Аналитики считают, что темная тема, мобильное приложение и чат с нейросетью не сильно увеличат внимание пользователей, поэтому эти задачи стоит отложить, или вообще отказаться от них.
4. Интеграция с новой платежной системой, добавление вкладки "избранное" и сортировка комнат по рейтингу требуют глубокой аналитики, прежде чем отправиться в стадию разработки.

## Гит граф 
```mermaid
gitGraph
   commit id: "Инициализация проекта"
   commit id: "Создание сервиса авторизации"
   commit id: "Создание сервиса валидации"
   commit id: "Создание сервиса генерации отчета"
   commit id: "Создание сервиса генерации чека"
   commit id: "Создание сервиса работы с пользователем"
   commit id: "Создание сервиса работы с горничными"
   commit id: "Создание сервиса работы с номерами"
   commit id: "Создание сервиса интеграции с нейросетью"
   commit id: "Создание сервиса бронирования"
   commit id: "Создание клиента"
   commit id: "Написание файлов развертывания в k8s"
   commit id: "Первая стабильная версия" tag: "1.0.0"
```
### Пояснение диаграммы
Данная  диаграмма предназачена для наблюдения истории разработки проекта.
По ней видно, что сначала создалась серверная часть, затем клиентская, затем все было развернуто в k8s.
